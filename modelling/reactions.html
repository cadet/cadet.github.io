
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Reaction models &#8212; CADET</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/cadet_icon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="File format specifications" href="../file_format/index.html" />
    <link rel="prev" title="Steric Mass Action" href="binding/steric_mass_action.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/cadet_logo.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=modsim&repo=cadet&type=fork&count=True&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simulation/index.html">Simulation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Modelling</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="networks.html">Networks of unit operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="unit_operations/index.html">Unit operation models</a></li>
<li class="toctree-l2"><a class="reference internal" href="binding/index.html">Binding models</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Reaction models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#correlation-of-forward-and-backward-rate-constants">Correlation of forward- and backward rate constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dependence-on-external-function">Dependence on external function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mass-action-law">Mass action law</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../file_format/index.html">File format specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zbibliography.html">Bibliography</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="reaction-models">
<span id="id1"></span><h1>Reaction models<a class="headerlink" href="#reaction-models" title="Permalink to this headline">¶</a></h1>
<p>Reaction models describe the (net) fluxes <span class="math notranslate nohighlight">\(f_{\text{react}}\)</span> of a
reaction mechanism. The most common mechanism is the mass action law.</p>
<div class="section" id="correlation-of-forward-and-backward-rate-constants">
<h2>Correlation of forward- and backward rate constants<a class="headerlink" href="#correlation-of-forward-and-backward-rate-constants" title="Permalink to this headline">¶</a></h2>
<p>Note that forward rate constant <span class="math notranslate nohighlight">\(k_{\text{fwd},i}\)</span> and backward
rate constant <span class="math notranslate nohighlight">\(k_{\text{bwd},i}\)</span> of reaction <span class="math notranslate nohighlight">\(i\)</span> are
linearly correlated due to the form of the equilibrium constant
<span class="math notranslate nohighlight">\(k_{\text{eq},i}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
    k_{\text{fwd},i} = k_{\text{eq},i} k_{\text{bwd},i}.
\end{aligned}\]</div>
<p>This correlation can potentially degrade performance of some optimization algorithms.
The parameters can be decoupled by reparameterization:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
    r_{\text{net},i} &amp;= k_{\text{fwd},i} f_{\text{fwd},i} - k_{\text{bwd},i} f_{\text{bwd},i} = k_{\text{bwd},i} \left[ k_{\text{eq},i} f_{\text{fwd},i} - f_{\text{bwd},i} \right] = k_{\text{fwd},i} \left[ f_{\text{fwd},i} - \frac{1}{k_{\text{eq},i}} f_{\text{bwd},i} \right].
\end{aligned}\]</div>
<p>This can be achieved by a (nonlinear) parameter transform</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    F\left( k_{\text{eq},i}, k_{\text{bwd},i} \right) = \begin{pmatrix} k_{\text{eq},i} k_{\text{bwd},i} \\ k_{\text{bwd},i} \end{pmatrix} \text{ with Jacobian } J_F\left( k_{\text{eq},i}, k_{\text{bwd},i} \right) = \begin{pmatrix} k_{\text{bwd},i} &amp; k_{\text{eq},i} \\ 0 &amp; 1 \end{pmatrix}.
\end{aligned}\end{split}\]</div>
</div>
<div class="section" id="dependence-on-external-function">
<span id="id2"></span><h2>Dependence on external function<a class="headerlink" href="#dependence-on-external-function" title="Permalink to this headline">¶</a></h2>
<p>A reaction model may depend on an external function or profile <span class="math notranslate nohighlight">\(T\colon \left[ 0, T_{\text{end}}\right] \times [0, L] \to \mathbb{R}\)</span>, where <span class="math notranslate nohighlight">\(L\)</span> denotes the physical length of the unit operation, or <span class="math notranslate nohighlight">\(T\colon \left[0, T_{\text{end}}\right] \to \mathbb{R}\)</span> if the unit operation model has no axial length.
By using an external profile, it is possible to account for effects that are not directly modeled in CADET (e.g., temperature).
The dependence of each parameter is modeled by a polynomial of third degree.
For example, the forward rate constant <span class="math notranslate nohighlight">\(k_{\text{fwd}}\)</span> is really given by</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
    k_{\text{fwd}}(T) &amp;= k_{\text{fwd},3} T^3 + k_{\text{fwd},2} T^2 + k_{\text{fwd},1} T + k_{\text{fwd},0}.
\end{aligned}\]</div>
<p>While <span class="math notranslate nohighlight">\(k_{\text{fwd},0}\)</span> is set by the original parameter <code class="docutils literal notranslate"><span class="pre">XXX_KFWD</span></code> of the file format (<code class="docutils literal notranslate"><span class="pre">XXX</span></code> being a placeholder for the reaction model), the parameters <span class="math notranslate nohighlight">\(k_{\text{fwd},3}\)</span>, <span class="math notranslate nohighlight">\(k_{\text{fwd},2}\)</span>, and <span class="math notranslate nohighlight">\(k_{\text{fwd},1}\)</span> are given by <code class="docutils literal notranslate"><span class="pre">XXX_KFWD_TTT</span></code>, <code class="docutils literal notranslate"><span class="pre">XXX_KFWD_TT</span></code>, and <code class="docutils literal notranslate"><span class="pre">XXX_KFWD_T</span></code>, respectively.
The identifier of the externally dependent reaction model is constructed from the original identifier by prepending <code class="docutils literal notranslate"><span class="pre">EXT_</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">MASS_ACTION_LAW</span></code> is changed into <code class="docutils literal notranslate"><span class="pre">EXT_MASS_ACTION_LAW</span></code>).
This pattern applies to all parameters and supporting reaction models.
Note that the parameter units have to be adapted to the unit of the external profile by dividing with an appropriate power.</p>
<p>Each parameter of the externally dependent reaction model can depend on a different external source.
The 0-based indices of the external source for each parameter is given in the dataset <code class="docutils literal notranslate"><span class="pre">EXTFUN</span></code>.
By assigning only one index to <code class="docutils literal notranslate"><span class="pre">EXTFUN</span></code>, all parameters use the same source.
The ordering of the parameters in <code class="docutils literal notranslate"><span class="pre">EXTFUN</span></code> is given by the ordering in the file format specification in Section <a class="reference internal" href="../file_format/reactions.html#ffreaction"><span class="std std-ref">Reaction models</span></a>.</p>
</div>
<div class="section" id="mass-action-law">
<span id="mrmassactionlaw"></span><h2>Mass action law<a class="headerlink" href="#mass-action-law" title="Permalink to this headline">¶</a></h2>
<p>The mass action law reaction model is suitable for most reactions.
Note that the concentrations are directly used for calculating the fluxes.
Hence, the model only holds for dilute solutions under the assumption of a well-stirred reaction vessel.
These assumptions can be weakened by passing to the generalized mass action law, which uses chemical activities instead of concentrations.</p>
<p>The mass action law states that the speed of a reaction is proportional to the product of the concentrations of their reactants.
The net flux for component <span class="math notranslate nohighlight">\(i\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
    f_{\text{react},i}^l\left(c^l\right) = \sum_{j=0}^{N_{\text{react}}-1} s_{i,j}^l \varphi^l_j\left(c^l\right), \qquad \varphi^l_j(c^l) = k^l_{\text{fwd},j} \prod_{\ell=0}^{N_{\text{comp}}-1} \left(c^l_{\ell}\right)^{e^l_{\text{fwd},\ell,j}} - k^l_{\text{bwd},j} \prod_{\ell=0}^{N_{\text{comp}}-1} \left(c^l_{\ell}\right)^{e^l_{\text{bwd},\ell,j}},
\end{aligned}\]</div>
<p>where <span class="math notranslate nohighlight">\(S^l = (s^l_{i,j}) \in \mathbb{R}^{N_{\text{comp}} \times N_{\text{react}}}\)</span> is the stoichiometric matrix, <span class="math notranslate nohighlight">\(\varphi^l_j(c)\)</span> is the net flux of reaction <span class="math notranslate nohighlight">\(j\)</span>, and <span class="math notranslate nohighlight">\(k^l_{\text{fwd},j}\)</span> and <span class="math notranslate nohighlight">\(k^l_{\text{bwd},j}\)</span> are the rate constants.
The matrices <span class="math notranslate nohighlight">\(E^l_{\text{fwd}} = (e^l_{\text{fwd},\ell,j}) \in \mathbb{R}^{N_{\text{comp}} \times N_{\text{react}}}\)</span> and <span class="math notranslate nohighlight">\(E^l_{\text{bwd}} = (e^l_{\text{bwd},\ell,j}) \in \mathbb{R}^{N_{\text{comp}} \times N_{\text{react}}}\)</span> are usually derived by the order of the reaction, that is,</p>
<div class="math notranslate nohighlight" id="equation-mrmassactionlawexpmatdefault">
<span class="eqno">(19)<a class="headerlink" href="#equation-mrmassactionlawexpmatdefault" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
    e^l_{\text{fwd},\ell,j} = -\min(0, s^l_{\ell,j}), \qquad e^l_{\text{bwd},\ell,j} = \max(0, -s^l_{\ell,j}).
\end{aligned}\]</div>
<p>However, these defaults can be changed by providing those matrices.</p>
<p>In situations where both liquid and solid phase are present (e.g., in a bead), the respective other phase may act as a modifier in the net flux equation.
For example, consider reactions in the liquid phase of a particle given by</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
    f_{\text{react},i}^p\left(c^p, c^s\right) &amp;= \sum_{j=0}^{N_{\text{react}}-1} s_{i,j}^p \varphi^p_j\left(c^p, c^s\right),\end{aligned}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
    \varphi^p_j(c^p, c^s) &amp;= k^p_{\text{fwd},j} \left[\prod_{\ell=0}^{N_{\text{comp}}-1} \left(c^p_{\ell}\right)^{e^p_{\text{fwd},\ell,j}}\right] \left[\prod_{m=0}^{\sum_{i=0}^{N_{\text{comp}}-1} N_{\text{bnd},i}-1} \left(c^s_{m}\right)^{e^{ps}_{\text{fwd},m,j}}\right] \\
     &amp;\phantom{=}\quad - k^p_{\text{bwd},j} \left[\prod_{\ell=0}^{N_{\text{comp}}-1} \left(c^p_{\ell}\right)^{e^p_{\text{bwd},\ell,j}}\right] \left[\prod_{m=0}^{\sum_{i=0}^{N_{\text{comp}}-1} N_{\text{bnd},i}-1} \left(c^s_{m}\right)^{e^{ps}_{\text{bwd},m,j}}\right].
\end{split}\end{split}\]</div>
<p>The forward and backward rates of the liquid phase particle reactions can be modified by a power of every bound state in the solid phase of the particle.
The exponents of these powers are given by the matrices <span class="math notranslate nohighlight">\(E^{ps}_{\text{fwd}} = (e^{ps}_{\text{fwd},m,j})\)</span> and <span class="math notranslate nohighlight">\(E^{ps}_{\text{bwd}} = (e^{ps}_{\text{bwd},m,j})\)</span>, which are both of size <span class="math notranslate nohighlight">\((\sum_i N_{\text{bnd},i}) \times N_{\text{react}}\)</span>.
Whereas the exponent matrices <span class="math notranslate nohighlight">\(E^{p}_{\text{fwd}}, E^{p}_{\text{bwd}} \in \mathbb{R}^{N_{\text{comp}} \times N_{\text{react}}}\)</span> are initialized based on the stoichiometric matrix <span class="math notranslate nohighlight">\(S^{p} \in \mathbb{R}^{N_{\text{comp}} \times N_{\text{react}}}\)</span>, see Eq. <a class="reference internal" href="#equation-mrmassactionlawexpmatdefault">19</a>, the exponent matrices <span class="math notranslate nohighlight">\(E^{ps}_{\text{fwd}}, E^{ps}_{\text{bwd}}\)</span> of the modifier terms default to <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>Vice versa, the rates of solid phase reactions can be modified by liquid phase concentrations.
The corresponding exponent matrices <span class="math notranslate nohighlight">\(E^{sp}_{\text{fwd}} = (e^{sp}_{\text{fwd},\ell,j})\)</span> and <span class="math notranslate nohighlight">\(E^{sp}_{\text{bwd}} = (e^{sp}_{\text{bwd},\ell,j})\)</span> are both of size <span class="math notranslate nohighlight">\(N_{\text{comp}} \times N_{\text{react}}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
    f_{\text{react},i}^s\left(c^s, c^p\right) &amp;= \sum_{j=0}^{N_{\text{react}}-1} s_{i,j}^s \varphi^s_j\left(c^s, c^p\right),
\end{aligned}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
    \varphi^s_j(c^s, c^p) &amp;= k^s_{\text{fwd},j} \left[\prod_{m=0}^{\sum_{i=0}^{N_{\text{comp}}-1} N_{\text{bnd},i}-1} \left(c^s_{m}\right)^{e^{s}_{\text{fwd},m,j}}\right] \left[\prod_{\ell=0}^{N_{\text{comp}}-1} \left(c^p_{\ell}\right)^{e^{sp}_{\text{fwd},\ell,j}}\right] \\
    &amp;\phantom{=}\quad - k^p_{\text{bwd},j} \left[\prod_{m=0}^{\sum_{i=0}^{N_{\text{comp}}-1} N_{\text{bnd},i}-1} \left(c^s_{m}\right)^{e^{s}_{\text{bwd},m,j}}\right] \left[\prod_{\ell=0}^{N_{\text{comp}}-1} \left(c^p_{\ell}\right)^{e^{sp}_{\text{bwd},\ell,j}}\right].
\end{split}\end{split}\]</div>
<p>Whereas the exponent matrices <span class="math notranslate nohighlight">\(E^{s}_{\text{fwd}}, E^{s}_{\text{bwd}} \in \mathbb{R}^{(\sum_i N_{\text{bnd},i}) \times N_{\text{react}}}\)</span> are initialized based on the stoichiometric matrix <span class="math notranslate nohighlight">\(S^{s} \in \mathbb{R}^{(\sum_i N_{\text{bnd},i}) \times N_{\text{react}}}\)</span>, see Eq. <a class="reference internal" href="#equation-mrmassactionlawexpmatdefault">19</a>, the exponent matrices <span class="math notranslate nohighlight">\(E^{sp}_{\text{fwd}}, E^{sp}_{\text{bwd}}\)</span> of the modifier terms default to <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>The layout of the matrices in the file format is presented in Table <a class="reference internal" href="../file_format/reactions.html#ffreactionmassactionlaw"><span class="std std-ref">Group /input/model/unit_XXX/reaction - REACTION_MODEL = MASS_ACTION_LAW</span></a>.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2008-2020.
      
      |
      <a href="../_sources/modelling/reactions.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
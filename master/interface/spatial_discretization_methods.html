<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Spatial discretization methods &#8212; CADET</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=795b792b" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://cadet.github.io/master/interface/spatial_discretization_methods.html" />
    <link rel="icon" href="../_static/cadet_icon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Flux reconstruction methods" href="flux_reconstruction.html" />
    <link rel="prev" title="Reaction models" href="reactions.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">CADET</a></h1>



<p class="blurb">CADET - An open platform for integrated process modelling and simulation</p>






<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modelling/index.html">Modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simulation/index.html">Simulation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Interface specifications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="input_group.html">Input Group</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="system.html">System of unit operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="unit_operations/index.html">Unit Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="binding/index.html">Binding models</a></li>
<li class="toctree-l3"><a class="reference internal" href="reactions.html">Reaction models</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Spatial discretization methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="flux_reconstruction.html">Flux reconstruction methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="consistent_initialization.html">Nonlinear solver for consistent initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="return_data.html">Return data</a></li>
<li class="toctree-l3"><a class="reference internal" href="sensitivities.html">Parameter Sensitivities</a></li>
<li class="toctree-l3"><a class="reference internal" href="solver.html">Solver Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="parameter_dependencies.html">Parameter Dependencies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="output_group.html">Output Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="meta_group.html">Meta Group</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://cadet.github.io/CADET-Match/master/index.html">CADET-Match</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zbibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.fz-juelich.de/portal/EN/Service/LegalNotice/_node.html">Legal notice</a></li>
</ul>


<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
<h3>Releases</h3>
<ul>
  <li><a href="../../v4.3.0/index.html">v4.3.0</a></li>
  <li><a href="../../v4.4.0/index.html">v4.4.0</a></li>
</ul>
<h3>Branches</h3>
<ul>
  <li><a href="spatial_discretization_methods.html">master</a></li>
  <li><a href="../../chore/developer_guide/interface/spatial_discretization_methods.html">chore/developer_guide</a></li>
</ul>

        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            

<p>
  <strong>
    
    You're reading the documentation for a development version.
    For the latest released version, please have a look at <a href="../../v4.4.0/index.html">v4.4.0</a>.
    
  </strong>
</p>


  <section id="spatial-discretization-methods">
<span id="id1"></span><h1>Spatial discretization methods<a class="headerlink" href="#spatial-discretization-methods" title="Link to this heading">¶</a></h1>
<section id="group-input-model-unit-xxx-discretization-spatial-method-details-on-the-methods">
<h2>Group /input/model/unit_XXX/discretization/SPATIAL_METHOD - Details on the methods<a class="headerlink" href="#group-input-model-unit-xxx-discretization-spatial-method-details-on-the-methods" title="Link to this heading">¶</a></h2>
<p>CADET offers two spatial discretization methods: Finite Volumes (FV) and Discontinuous Galerkin (DG).
While both methods approximate the same solution to the underlying models, they may differ in terms of computational performance.
Generally, FV can be more performant for small problem sizes and solutions with steep gradients, while DG excels for large problem sizes and smooth solutions.</p>
<p>In the following, we give a brief introduction to the numerical theory that is most relevant for the computational performance of the methods.
Based on that theory and our experience, we give advice on which method to use in which scenario, how to identify the more performant method, and how to specify the discretization parameters.
For a comprehensive description on the FV and DG methods as they are implemented in CADET, we refer to our publications on <a class="reference external" href="https://doi.org/10.1016/j.compchemeng.2010.03.008">CADET-FV</a>  and <a class="reference external" href="https://doi.org/10.1016/j.compchemeng.2023.108340">CADET-DG</a>.</p>
</section>
<section id="discrete-system-size">
<h2>Discrete system size<a class="headerlink" href="#discrete-system-size" title="Link to this heading">¶</a></h2>
<p>Numerical methods discretize the continuous (here: spatial) domain of the equations into a finite set of discrete points.
Then, a system of equations is formulated for those points, and both system size and number of unknowns / degrees of freedom (DoF) are given by the number of discrete points.
This system can be linear or non-linear, depending on the method (this will become important again in the section on smooth solutions).
The wall clock time to compute the solution depends on the system size and, thus, on the number of discrete points.
Conversely, the numerical solution is more accurate with more discrete points.
Thus, we trade computation time for approximation accuracy by specifying the parameters that determine the number of discrete points.
For the FV scheme, the number of axial discrete points in the column is given by the number of volume cells <code class="docutils literal notranslate"><span class="pre">NCOL</span></code>.
For the DG scheme, the number of axial discrete points in the column is given by the number of polynomial interpolation nodes (= <code class="docutils literal notranslate"><span class="pre">POLYDEG</span></code> + 1) times the number of DG elements <code class="docutils literal notranslate"><span class="pre">NELEM</span></code>.
The LRMP and GRM additionally consider particle equations that are also discretized.
In the spatially discretized equations, a single particle is incorporated at each axial discrete point, which increases the total number of DOF per axial point, especially for the GRM where particles are fully resolved.
The parameters for the GRM particle discretization are given for FV in <code class="docutils literal notranslate"><span class="pre">NPAR</span></code> and for DG in <code class="docutils literal notranslate"><span class="pre">PAR_POLYDEG</span></code> and <code class="docutils literal notranslate"><span class="pre">PAR_NELEM</span></code>.</p>
</section>
<section id="order-of-convergence">
<h2>Order of convergence<a class="headerlink" href="#order-of-convergence" title="Link to this heading">¶</a></h2>
<p>The computational performance of a numerical method depends on its theoretical order of convergence.
The order of convergence refers to the rate at which the method’s approximation approaches the exact solution under refinement of the spatial grid.</p>
<p>A higher-order method can be faster than a low-order method:
Imagine a high- and a low-order method’s approximation to exhibit similarly bad approximation accuracy due to a coarse spatial resolution.
Refining the grid for both methods by the same number of discrete points improves the approximation accuracy of the higher-order method more than the other one.
Thus, the low-order method requires more DOFs and ultimately more compute time to compute a solution of the same accuracy.</p>
<p>The theoretical order of convergence is an asymptotic property, however.
Having the exact solution, we can compute an experimental order of convergence (EOC) via the formula</p>
<div class="math notranslate nohighlight" id="equation-modelcolumn">
<span class="eqno">(26)<a class="headerlink" href="#equation-modelcolumn" title="Link to this equation">¶</a></span>\[\begin{aligned}
    EOC_k = \frac{log(\varepsilon_{k+1} / \varepsilon_{k}) }{log(n_{k} / n_{k+1})},
\end{aligned}\]</div>
<p>with <span class="math notranslate nohighlight">\(\varepsilon_{k}\)</span> and <span class="math notranslate nohighlight">\(n_{k}\)</span> denoting some error norm and the degrees of freedom of the kth approximation.
The EOC approaches the theoretical order of convergence for <span class="math notranslate nohighlight">\(k \rightarrow \infty\)</span> but is typically lower for underresolved problems.
High-order methods typically suffer from start-off problems, i.e. they typically won’t exhibit their high order until the grid is fine enough and a certain accuracy is already reached.
That is, increasing the number of discrete points from, e.g., 2 to 4 typically does not improve the solution according to the theoretical order of convergence but by a much smaller EOC.
The EOC is highly problem-dependent, and it is generally unknown when a high-order method will actually be faster than a lower-order method.
Experience shows that higher-order methods work well for smooth solutions.</p>
<p>The theoretical order of convergence for the CADET-FV scheme is fixed at 2.
For the CADET-DG scheme, it is <span class="math notranslate nohighlight">\(N_d + 1\)</span> with <span class="math notranslate nohighlight">\(N_d\)</span> denoting the polynomial degree, and can thus be user-defined by specifying the field <code class="docutils literal notranslate"><span class="pre">POLYDEG</span></code> (and <code class="docutils literal notranslate"><span class="pre">PAR_POLYDEG</span></code> for the GRM).
As a convergence order of <span class="math notranslate nohighlight">\(\gt 6\)</span> is hardly realized within the approximation error of engineering tolerance (due to start-off problems), we recommend a maximum polynomial order of 5.
As the FV scheme oftentimes yields an EOC of around 2.5 and is computationally more enhanced (less arithmetic operations per DOF and customized factorization) than the DG code, we recommend a polynomial degree of at least 3 to top this.</p>
</section>
<section id="smooth-solutions">
<h2>Smooth solutions<a class="headerlink" href="#smooth-solutions" title="Link to this heading">¶</a></h2>
<p>Smoothness in functions is characterized by the absence of sudden changes, reflected in the continuity and differentiability of the function and its derivatives.
In numerical simulation, smoothness indicators are often based on derivatives or moments of the solution.
That is, strong gradients and high frequencies are used to identify non-smooth parts of the solution.
Godunov’s order barrier theorem shows why the concept of smoothness plays a crucial role in the deployment of numerical methods.
It states that linear high-order methods that are monotonous are at most first-order accurate.
Linear higher-order (<span class="math notranslate nohighlight">\(\gt 1\)</span>) methods thus suffer from artificial oscillations at non-smooth parts of the solution, specifically at discontinuities and strong gradients.
Some higher-order methods, such as CADET-FV (2nd order), contain a non-linear mechanism to suppress these oscillations.
The non-linear WENO mechanism employed in CADET-FV can be fine-tuned via the fields specified here <a class="reference internal" href="flux_reconstruction.html#flux-restruction-methods"><span class="std std-ref">Flux reconstruction methods</span></a>.
Unfortunately, non-linear higher-order methods (order <span class="math notranslate nohighlight">\(\geq 3\)</span>) are either not applicable (e.g., undefined boundary treatment) or have other shortcomings, such as more highly problem-dependent parameters.</p>
<p>CADET-DG is a linear high-order method (arbitrary order) and thus exhibits oscillatory behaviour at strong gradients, which increases the approximation error and results in a smaller EOC for lower resolutions.
As strong gradients are a local phenomena that can be captured by employing more discrete points, DG becomes more performant again for higher resolutions.
This, however, might happen after the engineering error tolerance is by far surpassed.
Hence, CADET-FV as a stabilized lower-order method can be more performant, depending on the setting.
The DG scheme reduces its oscillatory behaviour by adding artificial numerical dispersion at element interfaces.
Thus, the use of a lower polynomial degree and more elements is recommended for rather non-smooth problems.</p>
<p>In Chromatography, mathematical discontinuities never happen, as there are always some dispersive effects in reality.
Chromatography models, however, allow for discontinuities if dispersion parameters are set to zero.
Moreover, steep and self-sharpening concentration fronts might appear due to binding.
Binding models that might cause self-sharpening concentration fronts are often associated with competitive Langmuir type isotherms for components with differently strong binding properties.
Nonetheless, a lot of chromatography settings yield rather smooth concentration profiles, for which DG is the better choice in terms of computational performance.</p>
</section>
<section id="recommendations-on-the-choice-of-spatial-discretization-methods">
<h2>Recommendations on the choice of spatial discretization methods<a class="headerlink" href="#recommendations-on-the-choice-of-spatial-discretization-methods" title="Link to this heading">¶</a></h2>
<p>We recommend the FV method for</p>
<ul class="simple">
<li><p>Small problem sizes, e.g., low spatial resolution with the LRM</p></li>
<li><p>Problems with strong gradients, e.g., no or low dispersion and bindings that create sharp fronts</p></li>
<li><p>Bindings that mathematically require positive values or exhibit strange behaviour with negative concentration values</p></li>
</ul>
<p>We recommend the DG method for</p>
<ul class="simple">
<li><p>Large problem sizes, e.g., high resolutions and more complex models (i.e. the LRMP and specifically the GRM)</p></li>
<li><p>Smooth problems, e.g., sufficient dispersion</p></li>
</ul>
</section>
<section id="recommendations-on-dg-discretization-parameters">
<h2>Recommendations on DG discretization parameters<a class="headerlink" href="#recommendations-on-dg-discretization-parameters" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Employ an axial polynomial degree between 3 and 5</p></li>
<li><p>Select a lower axial polynomial degree for non smooth tendency and employ more elements instead. Converse choice for smooth problems</p></li>
<li><p>Adjust the DG particle polynomial degree to control approximation accuracy; leave the number of elements at one. Make exceptions if very steep gradients occur inside the particles or when specific parts of the particle domain are more interesting (here, you can resolve more interesting parts by a user-defined spacing of multiple elements)</p></li>
<li><p>The field <code class="docutils literal notranslate"><span class="pre">EXACT_INTEGRATION</span></code> specifies the DG polynomial integration method. The default value of 0 (collocation DG) is expected to be slightly more performant in most settings</p></li>
</ul>
</section>
<section id="refinement-strategy">
<h2>Refinement strategy<a class="headerlink" href="#refinement-strategy" title="Link to this heading">¶</a></h2>
<p>A common problem in numerical simulation is that the number of discrete points required to yield an accurate approximation within a specific tolerance is unknown.
We thus recommend determining the approximation error via comparison with a refined reference approximation.
Both the theoretical order of convergence and the EOC can be used to estimate the required number of discrete points.</p>
</section>
<section id="note-on-dg-solution-vector">
<h2>Note on DG solution vector<a class="headerlink" href="#note-on-dg-solution-vector" title="Link to this heading">¶</a></h2>
<p>Any liquid or solid concentration within the column or particles is reported on the discrete points that are employed by the method.
That is, DG yields a piece-wise polynomial approximation on Lagrange-Gauss-Lobatto nodes.
If the solution is desired on a different grid, element-wise polynomial interpolation should be applied, and element interface values must be averaged.</p>
</section>
</section>



          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;2008-2024.
      
      |
      <a href="../_sources/interface/spatial_discretization_methods.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
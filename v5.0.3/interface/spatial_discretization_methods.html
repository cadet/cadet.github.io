<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Spatial discretization methods &#8212; CADET</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=2bcfc6fe" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://cadet.github.io/master/interface/spatial_discretization_methods.html" />
    <link rel="icon" href="../_static/cadet_icon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Output Group" href="output_group.html" />
    <link rel="prev" title="Parameter Dependencies" href="parameter_dependencies.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">CADET-Core</a></h1>



<p class="blurb">CADET - An open platform for integrated process modelling and simulation</p>






<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modelling/index.html">Modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simulation/index.html">Simulation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Interface specifications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="input_group.html">Input Group</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="system.html">System of unit operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="unit_operations/index.html">Unit Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="binding/index.html">Binding models</a></li>
<li class="toctree-l3"><a class="reference internal" href="population_balance_model.html">Population balance model</a></li>
<li class="toctree-l3"><a class="reference internal" href="reaction/index.html">Reaction models</a></li>
<li class="toctree-l3"><a class="reference internal" href="flux_reconstruction.html">Flux reconstruction methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="consistent_initialization.html">Nonlinear solver for consistent initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="return_data.html">Return data</a></li>
<li class="toctree-l3"><a class="reference internal" href="sensitivities.html">Parameter Sensitivities</a></li>
<li class="toctree-l3"><a class="reference internal" href="solver.html">Solver Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="parameter_dependencies.html">Parameter Dependencies</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Spatial discretization methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="output_group.html">Output Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="meta_group.html">Meta Group</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/index.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cadet.github.io/CADET-Match/master/index.html">CADET-Match</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zbibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.fz-juelich.de/en/legal-notice">Legal notice</a></li>
</ul>


<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
<h3>Releases</h3>
<ul>
  <li><a href="../../v4.3.0/index.html">v4.3.0</a></li>
  <li><a href="../../v4.4.0/index.html">v4.4.0</a></li>
  <li><a href="../../v5.0.0/interface/spatial_discretization_methods.html">v5.0.0</a></li>
  <li><a href="../../v5.0.1/interface/spatial_discretization_methods.html">v5.0.1</a></li>
  <li><a href="../../v5.0.2/interface/spatial_discretization_methods.html">v5.0.2</a></li>
  <li><a href="spatial_discretization_methods.html">v5.0.3</a></li>
  <li><a href="../../v5.0.4/interface/spatial_discretization_methods.html">v5.0.4</a></li>
  <li><a href="../../v5.1.0/interface/spatial_discretization_methods.html">v5.1.0</a></li>
</ul>
<h3>Branches</h3>
<ul>
  <li><a href="../../master/interface/spatial_discretization_methods.html">master</a></li>
  <li><a href="../../chore/developer_guide/interface/spatial_discretization_methods.html">chore/developer_guide</a></li>
</ul>

        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            

<p>
  <strong>
    
    You're reading an old version of this documentation.
    For the latest released version, please have a look at <a href="../../v5.1.0/interface/spatial_discretization_methods.html">v5.1.0</a>.
    
  </strong>
</p>


  <section id="spatial-discretization-methods">
<span id="id1"></span><h1>Spatial discretization methods<a class="headerlink" href="#spatial-discretization-methods" title="Link to this heading">¶</a></h1>
<section id="group-input-model-unit-xxx-discretization-spatial-method-details-on-the-methods">
<h2>Group /input/model/unit_XXX/discretization/SPATIAL_METHOD - Details on the methods<a class="headerlink" href="#group-input-model-unit-xxx-discretization-spatial-method-details-on-the-methods" title="Link to this heading">¶</a></h2>
<p>CADET offers two spatial discretization methods: Finite Volumes (FV) and Discontinuous Galerkin (DG).
While both methods approximate the same solution to the underlying models, they may differ in terms of computational performance.
Generally, FV can perform better for small problem sizes and solutions with steep gradients, while DG excels for large problem sizes and smooth solutions.</p>
<p>In the following, we give a brief introduction to the numerical theory w.r.t. the computational performance of the methods.
Based on that theory and our experience, we give advice on which method to use in which scenario, how to identify the computationally best performing method, and how to specify discretization parameters.
For a comprehensive description of the FV and DG variants that are implemented in CADET, we refer to our publications on <a class="reference external" href="https://doi.org/10.1016/j.compchemeng.2010.03.008">CADET-FV</a>  and <a class="reference external" href="https://doi.org/10.1016/j.compchemeng.2023.108340">CADET-DG</a>.</p>
</section>
<section id="discrete-system-size">
<h2>Discrete system size<a class="headerlink" href="#discrete-system-size" title="Link to this heading">¶</a></h2>
<p>FV and DG discretize the continuous spatial domain of the partial differential algebraic equations (PDAE) into a finite set of discrete points.
Then, a system of (semi-discrete) equations is formulated on those points, resulting in a system of ordinary differential algebraic equations (ODAE).
The system size and number of unknowns, are also referred to as degrees of freedom (DoF), is given by the number of (spatial) discrete points (times the number of components for multi-component systems).</p>
<p>The numerical solution becomes more accurate with more discrete points used, but the compute time required to solve the equations also increases.
That is, we trade compute time for approximation accuracy.</p>
<p>For the FV method, the number of axial discrete points in the column is specified by the number of volume cells <code class="docutils literal notranslate"><span class="pre">NCOL</span></code>.
For the DG method, the number of axial discrete points in the column is specified by the number of polynomial interpolation nodes (= <code class="docutils literal notranslate"><span class="pre">POLYDEG</span></code> + 1) times the number of DG elements <code class="docutils literal notranslate"><span class="pre">NELEM</span></code>.
The GRM additionally comprises a transport equation along the radial coordinate of the particles which is also spatially discretized and the particle discrete points are correspondingly given by <code class="docutils literal notranslate"><span class="pre">NPAR</span></code> for FV and for DG via <code class="docutils literal notranslate"><span class="pre">PAR_POLYDEG</span></code> and <code class="docutils literal notranslate"><span class="pre">PAR_NELEM</span></code>.</p>
</section>
<section id="order-of-convergence">
<h2>Order of convergence<a class="headerlink" href="#order-of-convergence" title="Link to this heading">¶</a></h2>
<p>The computational performance of a numerical method depends on its theoretical order of convergence.
The order of convergence refers to the rate at which the numerical approximation approaches the exact solution under refinement of the spatial grid.
Consequently, higher order methods often require less spatial discrete points to compute an approximation of the desired accuracy and can thus be computationally more efficient.</p>
<p>The theoretical order of convergence for the CADET-FV method is globally limited to 2.
It is locally (except column boundaries) limited to 3, with an improved order of up to 5 for smooth solutions, and can be varied by specifying the parameters described in the <a class="reference internal" href="flux_reconstruction.html#flux-reconstruction-methods"><span class="std std-ref">Flux reconstruction methods</span></a> section.
For the CADET-DG method, the theoretical order of convergence is <span class="math notranslate nohighlight">\(N_d + 1\)</span> with <span class="math notranslate nohighlight">\(N_d\)</span> denoting the polynomial degree, and can thus be user-defined by specifying the field <code class="docutils literal notranslate"><span class="pre">POLYDEG</span></code> (and <code class="docutils literal notranslate"><span class="pre">PAR_POLYDEG</span></code> for the particles in the GRM).</p>
<p>The theoretical order of convergence is an asymptotic property, i.e. holds for infinite refinements, but can be numerivcally observed for finite refinements as well.
Having the exact solution, we can compute an experimental order of convergence (EOC) via the formula</p>
<div class="math notranslate nohighlight" id="equation-modelcolumn">
<span class="eqno">(30)<a class="headerlink" href="#equation-modelcolumn" title="Link to this equation">¶</a></span>\[\begin{aligned}
    EOC_k = \frac{log(\varepsilon_{k+1} / \varepsilon_{k}) }{log(n_{k} / n_{k+1})},
\end{aligned}\]</div>
<p>with <span class="math notranslate nohighlight">\(\varepsilon_{k}\)</span> and <span class="math notranslate nohighlight">\(n_{k}\)</span> denoting some error norm and the degrees of freedom of the $k$th approximation.
The EOC approaches the theoretical order of convergence for <span class="math notranslate nohighlight">\(k \rightarrow \infty\)</span> but is typically lower for underresolved problems.
High-order methods typically do typically not exhibit their theoretical order on very coarse grids.
That is, increasing the number of discrete points from, e.g., 2 to 4 does often not improve the solution according to the theoretical order of convergence but by a much smaller EOC.</p>
<p>For smooth solutions, we typically observe an EOC of around 2.5 for the default CADET-FV method and around <span class="math notranslate nohighlight">\(N_d\)</span> for the CADET-DG method.
To our experience, DG with <span class="math notranslate nohighlight">\(N_d&gt;6\)</span> does usually not realize an EOC of <span class="math notranslate nohighlight">\(&gt;6\)</span> for approximation errors within engineering tolerances, i.e. higher rates are achieved only for excessively small error tolerances that are not relevant for most applications.
We thus recommend to choose <span class="math notranslate nohighlight">\(3 \leq N_d \leq 5\)</span> for the DG method.</p>
<p>One could still think that the higher the order of the method, the better the performance, but that is unfortunately not generally true, as the numerical solver performance can strongly depend on the smoothness of the approximated solution.</p>
</section>
<section id="smooth-solutions">
<h2>Smooth solutions<a class="headerlink" href="#smooth-solutions" title="Link to this heading">¶</a></h2>
<p>The smoothness of a function indicates the absence of sudden changes, reflected in the continuity and differentiability of the function and its derivatives.
In numerical simulation, smoothness indicators are often based on derivatives or moments of the solution.
That is, the occurrence of strong gradients and high frequencies are used to identify non-smooth parts of the solution.
Godunov’s order barrier theorem shows why the concept of smoothness plays a crucial role in the deployment of numerical methods.
It states that linear high-order methods that are monotonous are at most first-order accurate.
Linear higher-order (<span class="math notranslate nohighlight">\(\gt 1\)</span>) methods thus suffer from artificial oscillations at non-smooth parts of the solution, specifically at discontinuities and strong gradients.
Some higher-order methods, such as the FV variants implemented in CADET, contain a non-linear mechanism to suppress these oscillations.
The non-linear WENO mechanism employed in CADET-FV can be fine-tuned via the parameters specified in the <a class="reference internal" href="flux_reconstruction.html#flux-reconstruction-methods"><span class="std std-ref">Flux reconstruction methods</span></a> section.
Unfortunately, non-linear higher-order methods (here <span class="math notranslate nohighlight">\(\geq 3\)</span>) are either not applicable (e.g., undefined boundary treatment) or have other shortcomings, such as parameters whose optimal values can be highly proplem-specific.</p>
<p>The DG variant that is implemented in CADET is a linear high-order method (arbitrary order) and can thus exhibit oscillatory behaviour at strong gradients, which increases the approximation error and results in a smaller EOC for lower resolutions.
Since strong gradients are local phenomena which can be captured by employing more discrete points, DG performs better again for higher spatial resolutions.
This, however, might happen after the engineering error tolerance is by far surpassed.
Hence, CADET-FV as a stabilized lower-order method can perform better, depending on the smoothness of the approximated solution.
The DG method reduces its oscillatory behaviour by adding artificial numerical dispersion at element interfaces.
Thus, the use of a lower polynomial degree and more elements is recommended for non-smooth solutions.</p>
<p>In Chromatography, mathematical discontinuities never happen, as there are always some dispersive effects in reality.
Chromatography models, however, allow for discontinuities if dispersion parameters are set to zero.
Moreover, steep and self-sharpening concentration fronts might appear due to competitive adsorption.
Examples that can cause self-sharpening concentration fronts are often associated with competitive Langmuir type isotherms for components with differently strong binding properties.
Nonetheless, many chromatography settings yield rather smooth concentration profiles, for which DG is the better choice in terms of computational performance.</p>
</section>
<section id="recommendations-on-the-choice-of-spatial-discretization-methods">
<h2>Recommendations on the choice of spatial discretization methods<a class="headerlink" href="#recommendations-on-the-choice-of-spatial-discretization-methods" title="Link to this heading">¶</a></h2>
<p>We recommend the FV method for</p>
<ul class="simple">
<li><p>Small problem sizes, e.g., low spatial resolution with the LRM</p></li>
<li><p>Problems with strong gradients, e.g., no or low dispersion and binding model parameters that create sharp fronts</p></li>
<li><p>Binding models that mathematically require positive values or exhibit strange behaviour with negative concentration values</p></li>
</ul>
<p>We recommend the DG method for</p>
<ul class="simple">
<li><p>Large problem sizes, e.g., high spatial resolutions and more complex models (i.e. the LRMP and specifically the GRM)</p></li>
<li><p>Smooth problems, i.e., sufficient band broadening</p></li>
</ul>
</section>
<section id="recommendations-on-dg-discretization-parameters">
<h2>Recommendations on DG discretization parameters<a class="headerlink" href="#recommendations-on-dg-discretization-parameters" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Employ an axial polynomial degree between 3 and 5</p></li>
<li><p>Select a lower axial polynomial degree for approximating functions that tend to be less smooth and employ more elements instead. Converse choice for smooth problems</p></li>
<li><p>Adjust the DG particle polynomial degree to control approximation accuracy; leave the number of elements at one. Make exceptions if very steep gradients occur inside the particles or when specific regions of the particle domain are more interesting (the spatial resolution of certain regions can be refined by a user-defined spacing of multiple elements)</p></li>
<li><p>The field <code class="docutils literal notranslate"><span class="pre">EXACT_INTEGRATION</span></code> specifies the DG polynomial integration method. The default value of $0$ (collocation DG) is expected to be slightly more performant in most settings</p></li>
</ul>
</section>
<section id="refinement-strategy">
<h2>Refinement strategy<a class="headerlink" href="#refinement-strategy" title="Link to this heading">¶</a></h2>
<p>A common problem in numerical simulation is that the number of discrete points required to yield an accurate approximation within a specific tolerance is unknown.
We thus recommend determining the approximation error via comparison with a refined reference approximation.
Both the theoretical order of convergence and the EOC can be used to estimate the required number of discrete points.
An EOC that is significantly lower than the theoretical order indicates that the problem is numerically underresolved.</p>
</section>
<section id="note-on-dg-solution-vector">
<h2>Note on DG solution vector<a class="headerlink" href="#note-on-dg-solution-vector" title="Link to this heading">¶</a></h2>
<p>Any liquid or solid concentration within the column or particles is reported on the discrete points that are employed by the method.
That is, DG yields a piece-wise polynomial approximation on Lagrange-Gauss-Lobatto nodes.
If the solution is desired on a different grid, element-wise polynomial interpolation should be applied, and element interface values must be averaged.</p>
</section>
</section>



          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;2008-2026.
      
      |
      <a href="../_sources/interface/spatial_discretization_methods.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>